# 支持向量迴歸 (SVR) 筆記

## 目錄

- [支持向量迴歸 (SVR) 筆記](#支持向量迴歸-svr-筆記)
  - [目錄](#目錄)
  - [**1. 什麼是 SVR？**](#1-什麼是-svr)
    - [定義](#定義)
    - [工作原理](#工作原理)
    - [SVR 的數學公式](#svr-的數學公式)
  - [**2. SVR 的應用**](#2-svr-的應用)
    - [常見應用場景](#常見應用場景)
  - [**3. 使用場景與特性**](#3-使用場景與特性)
    - [**SVR 與其他回歸模型的區別**](#svr-與其他回歸模型的區別)
  - [**4. SVR 的優點與缺點**](#4-svr-的優點與缺點)
    - [**優點**](#優點)
    - [**缺點**](#缺點)
  - [**5. SVR 的核心參數**](#5-svr-的核心參數)
  - [**6. 什麼時候使用 SVR？**](#6-什麼時候使用-svr)
    - [**結論**](#結論)

## **1. 什麼是 SVR？**

### 定義

SVR 是基於 **支持向量機（Support Vector Machine, SVM）** 理論的一種回歸模型，用於解決迴歸問題。  
它與 SVM 用於分類的核心思想相似，但目的是**預測連續值**而非分類。

### 工作原理

- SVR 嘗試在允許一定誤差（\(\epsilon\)）的範圍內，找到一條超平面（直線或曲面），使得預測結果儘可能接近真實值。
- 重點是：
  - **容忍範圍**（\(\epsilon\))：允許部分數據偏離模型的預測，但偏差不能超過 \(\epsilon\)。
  - **支持向量**：只有那些位於 \(\epsilon\) 容忍範圍外的數據點對模型有影響。

### SVR 的數學公式

假設模型為：
\[
f(x) = w \cdot x + b
\]
其中：

- \(w\)：權重向量。
- \(b\)：偏置。

目標是找到一個平面，使得絕大部分的數據落在以下約束條件內：
\[
|y_i - (w \cdot x_i + b)| \leq \epsilon
\]

並最小化：
\[
\frac{1}{2}||w||^2
\]

這樣模型就能平衡預測精度與模型的複雜性。

---

## **2. SVR 的應用**

### 常見應用場景

1. **金融**

   - 預測股票價格、匯率變動等具有連續值的數據。

2. **工程**

   - 分析機械設備的性能指標（如壓力、溫度）隨時間的變化。

3. **醫療**

   - 預測病患的健康指標，例如血糖、血壓等連續數據。

4. **經濟與社會**
   - 預測房地產價格、人口增長趨勢。

---

## **3. 使用場景與特性**

### **SVR 與其他回歸模型的區別**

1. **非線性數據的處理能力**：

   - 與線性回歸不同，SVR 可以通過核函數（Kernel Function）處理非線性數據。
   - 例如，使用 RBF 核函數可以擬合複雜的非線性關係。

2. **對異常值的穩定性**：

   - SVR 通過 \(\epsilon\) 容忍範圍，能夠忽略小部分異常值的影響，而不會像普通最小二乘法（OLS）那樣受到極端值的過大影響。

3. **模型的靈活性**：
   - 通過調整參數 \(\epsilon\)、\(C\)（懲罰係數），可以控制模型的泛化能力與精度。

---

## **4. SVR 的優點與缺點**

### **優點**

1. **處理非線性問題**：結合核函數可以輕鬆應對非線性數據。
2. **對異常值不敏感**：SVR 的 \(\epsilon\) 容忍區間能忽略一些噪聲數據。
3. **靈活性**：可以調整參數適應不同的應用場景。

### **缺點**

1. **參數調試困難**：
   - 需要選擇合適的核函數（如線性核、RBF 核等）。
   - 需要調整 \(\epsilon\)、\(C\) 和核函數參數（如 \(\gamma\)）。
2. **計算成本高**：
   - 當數據量較大時，訓練過程的計算量顯著增加，尤其是使用非線性核函數時。
3. **解釋性弱**：
   - 相較於線性回歸，SVR 的結果不易直觀解釋，特別是使用非線性核時。

---

## **5. SVR 的核心參數**

1. **\(\epsilon\)（容忍誤差）**：

   - 控制模型對誤差的容忍範圍，較大的 \(\epsilon\) 允許更多數據點落在誤差範圍內，模型更簡單。

2. **\(C\)（懲罰係數）**：

   - 控制模型在容忍範圍外數據點的懲罰力度。
   - 大 \(C\) 值強調減少容忍範圍外的誤差，可能導致過擬合。

3. **Kernel（核函數）**：
   - 決定模型的非線性擬合能力。常見的核函數包括：
     - 線性核（Linear Kernel）
     - 多項式核（Polynomial Kernel）
     - 徑向基核（RBF Kernel）

---

## **6. 什麼時候使用 SVR？**

- **非線性數據建模**：如果數據顯示非線性趨勢，且無法用簡單回歸模型擬合時，可以考慮 SVR。
- **需要穩健性時**：當數據中存在異常值或噪聲，但這些數據對整體模型影響不大。
- **對小規模數據的高效建模**：SVR 在處理小數據集時表現優異，但對大數據集效率較低。

---

### **結論**

SVR 是一種強大的迴歸工具，特別適合於非線性數據和對異常值敏感的場景。它的核心思想基於支持向量機，並通過加入 \(\epsilon\) 容忍區間，使得模型更加穩健和靈活。如果需要進一步深入，可以嘗試調整參數並結合不同的核函數進行實驗！
